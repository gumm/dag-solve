'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(a){return{value:a,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var e=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(e);if(!e.done)return this.context_.stop_(),e;var f=e.value}catch(h){return this.context_.yieldAllIterator_=null,this.context_.throw_(h),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,f);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){$jscomp.generator.Generator_.prototype=a.prototype;return new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b))};
$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,e,f){return c==a&&"q"==e&&f==b}}));return!0===b.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill=function(a,b,c,e){if(b){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var f=a[e];f in c||(c[f]={});c=c[f]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),e=new a([[b,2],[c,3]]);if(2!=e.get(b)||3!=e.get(c))return!1;e.delete(b);e.set(c,4);return!e.has(b)&&4==e.get(c)}catch(r){return!1}}function c(a){$jscomp.owns(a,f)||$jscomp.defineProperty(a,f,{value:{}})}function e(a){var b=Object[a];b&&(Object[a]=function(a){c(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;
var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var h=0,k=function(a){this.id_=(h+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};k.prototype.set=function(a,b){c(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};k.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};k.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};k.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return k},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var e=c.entries(),f=e.next();if(f.done||f.value[0]!=b||"s"!=f.value[1])return!1;f=e.next();return f.done||4!=f.value[0].x||"t"!=f.value[1]||!e.next().done?!1:!0}catch(u){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=new WeakMap,e=function(a){this.data_={};this.head_=k();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};e.prototype.set=function(a,b){var c=f(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};e.prototype.delete=function(a){a=f(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=k();this.size=0};e.prototype.has=function(a){return!!f(this,a).entry};
e.prototype.get=function(a){return(a=f(this,a).entry)&&a.value};e.prototype.entries=function(){return h(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return h(this,function(a){return a.key})};e.prototype.values=function(){return h(this,function(a){return a.value})};e.prototype.forEach=function(a,b){for(var c=this.entries(),e;!(e=c.next()).done;)e=e.value,a.call(b,e[1],e[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var f=function(a,b){var e=b&&typeof b;"object"==
e||"function"==e?c.has(b)?e=c.get(b):(e=""+ ++n,c.set(b,e)):e="p_"+b;var f=a.data_[e];if(f&&$jscomp.owns(a.data_,e))for(a=0;a<f.length;a++){var h=f[a];if(b!==b&&h.key!==h.key||b===h.key)return{id:e,list:f,index:a,entry:h}}return{id:e,list:f,index:-1,entry:void 0}},h=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},k=function(){var a={};return a.previous=
a.next=a.head=a},n=0;return e},"es6","es3");$jscomp.polyfill("Number.isNaN",function(a){return a?a:function(a){return"number"===typeof a&&isNaN(a)}},"es6","es3");$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,e={next:function(){if(c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill("Array.prototype.entries",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return[a,c]})}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var f=b.length;c=c||0;for(0>c&&(c=Math.max(c+f,0));c<f;c++){var h=b[c];if(h===a||Object.is(h,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es8","es3");
$jscomp.polyfill("Set",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var h=c.entries(),k=h.next();if(k.done||k.value[0]!=b||k.value[1]!=b)return!1;k=h.next();return k.done||k.value[0]==b||4!=k.value[0].x||k.value[1]!=k.value[0]?!1:h.next().done}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};c.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};c.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};c.prototype.clear=function(){this.map_.clear();
this.size=0};c.prototype.has=function(a){return this.map_.has(a)};c.prototype.entries=function(){return this.map_.entries()};c.prototype.values=function(){return this.map_.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(e){return a.call(b,e,e,c)})};return c},"es6","es3");
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var e=a.length,f=0;f<e;f++){var h=a[f];if(b.call(c,h,f,a))return{i:f,v:h}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
var dag_solve=function(){function a(d){var g;return $jscomp.generator.createGenerator(a,function(a){switch(a.nextAddress){case 1:g=d?d+1:0;case 2:return a.yield(g++,2)}})}var b=function(a){for(var d=0;d<arguments.length;++d);},c=function(a){for(var d=0;d<arguments.length;++d);return!1};(new Map).set("true",!0).set("false",!1);var e=function(a){return void 0!==a},f=function(a){return"string"===typeof a},h=function(a){return"number"===typeof a&&!Number.isNaN(a)},k=function(a,g){return a.length===g.length&&
a.every(function(a,d){return g[d]===a})},n=function(a,g){return function(d){d=g.reduce(function(a,d){try{return a[d]}catch(O){}},d);return void 0===d?a:d}},t=function(a){var d=Math.pow(10,a);return function(a){return Math.round(a*d)/d}},p=function(a){return f(a)&&!Number.isNaN(r(a))},r=function(a){return parseInt(a.split("$").join(""),10)-1},B=function(a,g){return a.filter(function(a){return a[0]!==g})},u=function(a){try{var d=JSON.parse(a)}catch(N){}return d},C=new Map([["!=",function(a,g){return a!=
g}],["==",function(a,g){return a==g}],["!==",function(a,g){return a!==g}],["===",function(a,g){return a===g}],["<=",function(a,g){return a<=g}],[">=",function(a,g){return a>=g}],["<",function(a,g){return a<g}],[">",function(a,g){return a>g}]]),v=new Map([["vu",function(a,g,b){return a?g:void 0}],["10",function(a,g,b){return a?1:0}],["tf",function(a,g,b){return a}],["ab",function(a,g,b){return a?g:b}]]),D=function(a){var d=[].concat($jscomp.arrayFromIterable("+-*/%()".split("")),$jscomp.arrayFromIterable("0123456789.".split("")),
$jscomp.arrayFromIterable(["$"," ","'"]),$jscomp.arrayFromIterable("& | ^ ~ << >> >>>".split(" ")),$jscomp.arrayFromIterable(["int","len"]));return[].concat($jscomp.arrayFromIterable(a)).filter(function(a){return d.includes(a)}).join("")},w=function(a){try{return[null,new Function("X","\n      const len = e => ('' + e).length;\n      const int = e => parseInt(e, 10);\n      try { return "+a+"; } catch(e) { return; }\n      ")]}catch(g){return['Could not make a function with "'+a+'"',b]}},E=function(a,
g){var d="Unable to clean math",c=b;f(a)?(a=g.reduce(function(a,d,g){return a.split("$"+(g+1)).join("X.get("+d+")")},D(a)),a.includes("$")||(c=$jscomp.makeIterator(w(a)),d=c.next().value,c=c.next().value)):(c=$jscomp.makeIterator(w(a)),d=c.next().value,c=c.next().value);return[d,c]},F=function(a,g){a=a.map(function(a){a=$jscomp.makeIterator(a);var d=a.next().value,b=a.next().value;if(f(b)&&p(b)){var c=r(b);return[d,function(a){return a.get(g[c])}]}return[d,function(){return b}]});var d=new Map(a);
return[null,function(a){var b=d.get(a.get(g[0]));return b?b(a):void 0}]},G=function(a,g){var d=t(a);return[null,function(a){return d(a.get(g[0]))}]},q=function(a,g){if(f(a)){var d=r(a);var b=function(a){return a.get(g[d])}}else b=function(){return a};return b},H=function(a,g){var d=$jscomp.makeIterator(a);a=d.next().value;var e=d.next().value,f=d.next().value;d=d.next().value;var h=q(a,g),l=q(f,g),k=C.get(e)||c,m=v.get(d)||b;return[null,function(a){var d=$jscomp.makeIterator([h(a),l(a)]);a=d.next().value;
d=d.next().value;return m(k(a,d),a,d)}]},I=function(a,g){var d=$jscomp.makeIterator(a);a=d.next().value;var c=d.next().value,e=d.next().value;d=d.next().value;var f=q(a,g),h=q(c,g),l=q(e,g),k=v.get(d)||b;return[null,function(a){var d=$jscomp.makeIterator([f(a),h(a),l(a)]);a=d.next().value;var g=d.next().value;d=d.next().value;d=$jscomp.makeIterator([Math.min(g,d),Math.max(g,d)]);g=d.next().value;d=d.next().value;return a>=g&&a<=d?k(!0,a,g):a>=g?k(!1,a,d):k(!1,a,g)}]},J=function(a,g){return[null,k(a,
[null])?function(a){return a.get("data")}:function(d){return n(void 0,a)(d.get("data"))}]},K=function(a,g){g=$jscomp.makeIterator(a);a=g.next().value;g=g.next().value;var d=["_ev",a.toString(),g];return[null,function(a){return n(void 0,d)(a.get("data"))}]},l=function(a,g,c){var d=this;this._id=a;this._name=g;this._args=[];this._math=void 0;this._enum=[];this._comparator=[];this._between=[];this._round=void 0;this._path=[];this._evCode=[];this._fallback=void 0;this._nodus="Not init";this._func=b;c&&
(this._id=c.I,this.name=c.N,this.setFallback(c.D),this.setMath(c.M),c.E.forEach(function(a){a&&d.addEnum.apply(d,$jscomp.arrayFromIterable(a))}),this.setRound(c.R),this.setPath.apply(this,$jscomp.arrayFromIterable(c.P)),this.setComparator.apply(this,$jscomp.arrayFromIterable(c.C)),this.setBetween.apply(this,$jscomp.arrayFromIterable(c.B)),this.setEvCode.apply(this,$jscomp.arrayFromIterable(c.V)))};l.prototype.dump=function(){return{A:this._args,B:this._between,C:this._comparator,D:this._fallback,
E:this._enum,I:this.id,M:this._math,N:this.name,P:this._path,R:this._round,V:this._evCode}};l.prototype._clearAll=function(a){this._path=[];this._enum=void 0===a||a?[]:this._enum;this._comparator=[];this._between=[];this._evCode=[];this._math=this._round=void 0;this._nodus="Changed"};l.prototype.reset=function(){this._clearAll(!0);this._fallback=void 0;this._nodus="Not init"};l.prototype.addArg=function(a){this._args.push(a._id);this._nodus="Args added";return this};l.prototype.delArg=function(a){this._args=
this._args.filter(function(d){return d!==a._id});this._nodus="Args removed";return this};l.prototype.setAllArgs=function(a){Array.isArray(a)&&a.every(h)&&(this._args=a)};l.prototype.setFallback=function(a){this._fallback=a;return this};l.prototype.setEvCode=function(a,g){if(e(a)){this._clearAll();var d="data";g&&(g=g.toLowerCase(),d=["data","desc","code"].includes(g)?g:d);this._evCode=[a,d]}return this};l.prototype.setPath=function(a){for(var d=[],b=0;b<arguments.length;++b)d[b-0]=arguments[b];[].concat($jscomp.arrayFromIterable(d)).length&&
[].concat($jscomp.arrayFromIterable(d)).every(e)&&(this._clearAll(),this._path=[].concat($jscomp.arrayFromIterable(d)));return this};l.prototype.setMath=function(a){e(a)&&(this._clearAll(),this._math=a);return this};l.prototype.setRound=function(a){h(a)&&(this._clearAll(),this._round=t(0)(a));return this};l.prototype.setComparator=function(a,b,c,e){var d=!0;d=(h(a)||p(a))&&d;d=(h(c)||p(c))&&d;d="!= !== == === <= >= < >".split(" ").includes(b)&&d;if(d=["vu","10","tf","ab"].includes(e)&&d)this._clearAll(),
this._comparator=[a,b,c,e];return this};l.prototype.setBetween=function(a,b,c,e){var d=!0;d=(h(a)||p(a))&&d;d=(h(b)||p(b))&&d;d=(h(c)||p(c))&&d;if(d=["vu","10","tf","ab"].includes(e)&&d)this._clearAll(),this._between=[a,b,c,e];return this};l.prototype.addEnum=function(a,b){if(void 0===a)return this;this._clearAll(!1);this._enum=[].concat($jscomp.arrayFromIterable((new Map(this._enum)).set(a,b).entries()));return this};l.prototype.delEnum=function(a){this._enum=B(this._enum,a);this._nodus="Changed";
return this};l.prototype.clean=function(){var a=this,b=[this._nodus,this._func];this.math?b=E(this.math,this.args):this.enum&&this.enum.length?b=F(this.enum,this.args):e(this.round)?b=G(this.round,this.args):this.comparator&&this.comparator.length?b=H(this.comparator,this.args):this.between&&this.between.length?b=I(this.between,this.args):this.path&&this.path.length?b=J(this.path,this.args):this.evCode&&2===this.evCode.length?b=K(this.evCode,this.args):this._fallback&&(b=[null,function(){return a._fallback}]);
b=$jscomp.makeIterator(b);this._nodus=b.next().value;this._func=b.next().value;return this};l.prototype.solve=function(a){if(this._nodus)this.clean();else{var d=this._func(a);return a.set(this._id,void 0===d?this.fallback:d)}return this._nodus?(a.set(this._id,void 0),a.set("err_"+this._id,!this._nodus),a):this.solve(a)};l.isIn=function(a){return function(d,b){b=$jscomp.makeIterator(b);var c=b.next().value;return b.next().value.has(a)?d.push(c)&&d:d}};$jscomp.global.Object.defineProperties(l.prototype,
{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},name:{configurable:!0,enumerable:!0,get:function(){return this._name},set:function(a){this._name=a}},args:{configurable:!0,enumerable:!0,get:function(){return this._args}},fallback:{configurable:!0,enumerable:!0,get:function(){return this._fallback}},evCode:{configurable:!0,enumerable:!0,get:function(){return this._evCode}},path:{configurable:!0,enumerable:!0,get:function(){return this._path}},math:{configurable:!0,enumerable:!0,
get:function(){return this._math}},round:{configurable:!0,enumerable:!0,get:function(){return this._round}},comparator:{configurable:!0,enumerable:!0,get:function(){return this._comparator}},between:{configurable:!0,enumerable:!0,get:function(){return this._between}},enum:{configurable:!0,enumerable:!0,get:function(){return this._enum}}});var x=function(a){return a.id},y=function(a){var d=[].concat($jscomp.arrayFromIterable(a.keys())).reduce(function(a,d){return a.set(d,0)||a},new Map);[].concat($jscomp.arrayFromIterable(a.values())).forEach(function(a){return a.forEach(function(a){return d.set(a,
d.has(a)?d.get(a)+1:0)})});a=[].concat($jscomp.arrayFromIterable(a.keys())).filter(function(a){return 0===d.get(a)});return{C:d,Q:a}},L=function(a){var d=y(a),b=d.C,c=d.Q;for(d=[];c.length;){var e=c.pop();d.push(e);a.get(e).forEach(function(a){b.set(a,b.get(a)-1);0===b.get(a)&&c.push(a)})}return d},z=function(a){for(var d=$jscomp.makeIterator(a.entries()),b=d.next();!b.done;b=d.next()){var c=$jscomp.makeIterator(b.value);b=c.next().value;if(0===c.next().value.size&&0!==b){a.delete(b);c=$jscomp.makeIterator(a.values());
for(var e=c.next();!e.done;e=c.next())e.value.delete(b)}}[].concat($jscomp.arrayFromIterable(a.entries())).reduce(function(a,d){return a||0===d[1].size&&0!==d[0]},!1)&&z(a);return a},A=function(a){return function(d){return new l(a.next().value,d)}},m=function(){this._ref=this._meta=null;this._units=this._description="";this.G=new Map;this._nodeMaker=A(a());this._rootNode=this.makeNode("ROOT");this._rootNode.setMath("$1")};m.prototype.makeNode=function(a){a=this._nodeMaker(a);this.G.set(a,new Set);
return a};m.prototype.addNode=function(d){if(this.G.has(d))return d;if(this.ids.includes(d.id))return!1;this.G.set(d,new Set);this._nodeMaker=A(a(Math.max.apply(Math,$jscomp.arrayFromIterable(this.ids))));return d};m.prototype.delNode=function(a){var d=!1;if(a&&a!==this._rootNode&&(d=this.G.delete(a)))for(var b=$jscomp.makeIterator(this.G.entries()),c=b.next();!c.done;c=b.next()){c=$jscomp.makeIterator(c.value);var e=c.next().value;c.next().value.delete(a);e.delArg(a)}return d};m.prototype.connect=
function(a,b){if(a===this.root||b===this.root&&0<this.indegrees(b).length||!this.G.has(a)||!this.G.has(b)||this.G.get(a).has(b))return this;this.G.get(a).add(b);b.addArg(a);this.topo.length<this.nodes.length&&this.disconnect(a,b);return this};m.prototype.disconnect=function(a,b){this.G.has(a)&&(this.G.get(a).delete(b),b.delArg(a));return this};m.prototype.clean=function(){var a=this;this.orphans.forEach(function(b){return a.delNode(b)});this.orphans.length&&this.clean();this.nodes.forEach(function(a){return a.clean()});
return this};m.prototype.indegrees=function(a){a=l.isIn(a);return[].concat($jscomp.arrayFromIterable(this.G.entries())).reduce(a,[])};m.prototype.outdegrees=function(a){return[].concat($jscomp.arrayFromIterable(this.G.get(a)))};m.prototype.getIdG=function(){return[].concat($jscomp.arrayFromIterable(this.G)).reduce(function(a,b){var d=$jscomp.makeIterator(b);b=d.next().value;d=d.next().value;return a.set(b.id,new Set([].concat($jscomp.arrayFromIterable(d)).map(x)))},new Map)};m.prototype.solve=function(a){return this.getSolver()(a)};
m.prototype.debug=function(a){return this.getSolver(!0)(a)};m.prototype.getSolver=function(a){a=void 0===a?!1:a;var b=z(this.getIdG()),d=this.topo.filter(function(a){return b.has(a.id)}),c=d.map(x),e=d.map(function(a){return a.clean()}),f=this._rootNode.id,h=new Map;h.set("topoIds",c);return function(b){h.set("data",b);b=e.reduce(function(a,b){return b.solve(a)},h);return a?b:b.get(f)}};m.prototype.dump=function(){return JSON.stringify({M:[this.description,this.units,this.ref],G:[].concat($jscomp.arrayFromIterable(this.getIdG())).map(function(a){var b=
$jscomp.makeIterator(a);a=b.next().value;b=b.next().value;return[a,[].concat($jscomp.arrayFromIterable(b))]}),N:this.topo.map(function(a){return a.dump()})})};m.read=function(a){var b=u(a);if(b)try{var c=b.N.map(function(a){return new l(-1,void 0,a)}),d=function(a){return function(b){return b.id===a}},e=new Map(b.G),f=new m;f.G=new Map;for(var h=$jscomp.makeIterator(e.keys()),k=h.next();!k.done;k=h.next())f.addNode(c.find(d(k.value)));f._rootNode=f.nodes[0];a={};for(var p=$jscomp.makeIterator(e.entries()),
n=p.next();!n.done;a={node:a.node},n=p.next()){var q=$jscomp.makeIterator(n.value),r=q.next().value,t=q.next().value;a.node=c.find(d(r));t.forEach(function(a){return function(b){b=c.find(d(b));f.connect(a.node,b)}}(a))}f.nodes.forEach(function(a){a.setAllArgs(b.N.find(function(b){return b.I===a.id}).A)});f.description=b.M?b.M[0]||"":"";f.units=b.M?b.M[1]||"":"";f.ref=b.M?b.M[2]:null;return f}catch(M){console.log(M)}};$jscomp.global.Object.defineProperties(m.prototype,{meta:{configurable:!0,enumerable:!0,
get:function(){return this._meta},set:function(a){this._meta=a}},description:{configurable:!0,enumerable:!0,get:function(){return this._description},set:function(a){this._description=f(a)?a:this._description}},units:{configurable:!0,enumerable:!0,get:function(){return this._units},set:function(a){this._units=f(a)?a:this._units}},ref:{configurable:!0,enumerable:!0,get:function(){return this._ref},set:function(a){this._ref=e(a)?a:null}},root:{configurable:!0,enumerable:!0,get:function(){return this._rootNode}},
nodes:{configurable:!0,enumerable:!0,get:function(){return[].concat($jscomp.arrayFromIterable(this.G.keys()))}},graph:{configurable:!0,enumerable:!0,get:function(){return this.G}},topo:{configurable:!0,enumerable:!0,get:function(){return L(this.G)}},leafs:{configurable:!0,enumerable:!0,get:function(){return y(this.G).Q}},orphans:{configurable:!0,enumerable:!0,get:function(){for(var a=[],b=$jscomp.makeIterator(this.G.entries()),c=b.next();!c.done;c=b.next()){c=$jscomp.makeIterator(c.value);var e=c.next().value;
0===c.next().value.size&&e!==this._rootNode&&a.push(e)}return a}},names:{configurable:!0,enumerable:!0,get:function(){return this.nodes.map(function(a){return a.name})}},topoNames:{configurable:!0,enumerable:!0,get:function(){return this.topo.map(function(a){return a.name})}},ids:{configurable:!0,enumerable:!0,get:function(){return this.nodes.map(function(a){return a.id})}},topoIds:{configurable:!0,enumerable:!0,get:function(){return this.topo.map(function(a){return a.id})}}});return m}();
