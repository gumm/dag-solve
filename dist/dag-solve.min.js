'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var c=a.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(c.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,c){c?this.finallyContexts_[c]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(a){return{value:a,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,c){try{var e=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(e);if(!e.done)return this.context_.stop_(),e;var f=e.value}catch(h){return this.context_.yieldAllIterator_=null,this.context_.throw_(h),this.nextStep_()}this.context_.yieldAllIterator_=null;c.call(this.context_,f);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};$jscomp.initSymbolIterator();this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){$jscomp.generator.Generator_.prototype=a.prototype;return new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b))};
$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,e,f){return c==a&&"q"==e&&f==b}}));return!0===b.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill=function(a,b,c,e){if(b){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var f=a[e];f in c||(c[f]={});c=c[f]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),n=Object.seal({}),c=new a([[b,2],[n,3]]);if(2!=c.get(b)||3!=c.get(n))return!1;c.delete(b);c.set(n,4);return!c.has(b)&&4==c.get(n)}catch(u){return!1}}function c(a){$jscomp.owns(a,f)||$jscomp.defineProperty(a,f,{value:{}})}function e(a){var b=Object[a];b&&(Object[a]=function(a){c(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;
var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var h=0,g=function(a){this.id_=(h+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};g.prototype.set=function(a,b){c(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};g.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};g.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};g.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return g},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var e=c.entries(),f=e.next();if(f.done||f.value[0]!=b||"s"!=f.value[1])return!1;f=e.next();return f.done||4!=f.value[0].x||"t"!=f.value[1]||!e.next().done?!1:!0}catch(t){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=new WeakMap,e=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};e.prototype.set=function(a,b){var c=f(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};e.prototype.delete=function(a){a=f(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};e.prototype.has=function(a){return!!f(this,a).entry};
e.prototype.get=function(a){return(a=f(this,a).entry)&&a.value};e.prototype.entries=function(){return h(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return h(this,function(a){return a.key})};e.prototype.values=function(){return h(this,function(a){return a.value})};e.prototype.forEach=function(a,b){for(var c=this.entries(),e;!(e=c.next()).done;)e=e.value,a.call(b,e[1],e[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var f=function(a,b){var e=b&&typeof b;"object"==
e||"function"==e?c.has(b)?e=c.get(b):(e=""+ ++p,c.set(b,e)):e="p_"+b;var f=a.data_[e];if(f&&$jscomp.owns(a.data_,e))for(a=0;a<f.length;a++){var g=f[a];if(b!==b&&g.key!==g.key||b===g.key)return{id:e,list:f,index:a,entry:g}}return{id:e,list:f,index:-1,entry:void 0}},h=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},p=0;return e},"es6","es3");$jscomp.polyfill("Number.isNaN",function(a){return a?a:function(a){return"number"===typeof a&&isNaN(a)}},"es6","es3");$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,e={next:function(){if(c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill("Array.prototype.entries",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return[a,c]})}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var f=b.length;c=c||0;for(0>c&&(c=Math.max(c+f,0));c<f;c++){var h=b[c];if(h===a||Object.is(h,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es8","es3");
$jscomp.polyfill("Set",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var h=c.entries(),g=h.next();if(g.done||g.value[0]!=b||g.value[1]!=b)return!1;g=h.next();return g.done||g.value[0]==b||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:h.next().done}catch(p){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};c.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};c.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};c.prototype.clear=function(){this.map_.clear();
this.size=0};c.prototype.has=function(a){return this.map_.has(a)};c.prototype.entries=function(){return this.map_.entries()};c.prototype.values=function(){return this.map_.values()};c.prototype.keys=c.prototype.values;c.prototype[Symbol.iterator]=c.prototype.values;c.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(e){return a.call(b,e,e,c)})};return c},"es6","es3");
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var e=a.length,f=0;f<e;f++){var h=a[f];if(b.call(c,h,f,a))return{i:f,v:h}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
var dag_solve=function(){function a(d){var k;return $jscomp.generator.createGenerator(a,function(a){switch(a.nextAddress){case 1:k=d?d+1:0;case 2:return a.yield(k++,2)}})}var b=function(a){for(var d=0;d<arguments.length;++d);},c=function(a){for(var d=0;d<arguments.length;++d);return!1};(new Map).set("true",!0).set("false",!1);var e=function(a){return"string"===typeof a},f=function(a){return"number"===typeof a&&!Number.isNaN(a)},h=function(a,k){return a.length===k.length&&a.every(function(a,d){return k[d]===
a})},g=function(a,k){return function(d){d=k.reduce(function(a,d){try{return a[d]}catch(N){}},d);return void 0===d?a:d}},p=function(a){var d=Math.pow(10,a);return function(a){return Math.round(a*d)/d}},n=function(a){return e(a)&&!Number.isNaN(r(a))},r=function(a){return parseInt(a.split("$").join(""),10)-1},u=function(a){return function(d,b){b=$jscomp.makeIterator(b);var k=b.next().value;return b.next().value.has(a)?d.push(k)&&d:d}},A=function(a,k){return a.filter(function(a){return a[0]!==k})},t=
function(a){return a._id},B=function(a){try{var d=JSON.parse(a)}catch(M){}return d},C=function(a){return{"!=":function(a,d){return a!=d},"==":function(a,d){return a==d},"!==":function(a,d){return a!==d},"===":function(a,d){return a===d},"<=":function(a,d){return a<=d},">=":function(a,d){return a>=d},"<":function(a,d){return a<d},">":function(a,d){return a>d}}[a]||c},v=function(a){return{vu:function(a,d,b){return a?d:void 0},10:function(a,d,b){return a?1:0},tf:function(a,d,b){return a},ab:function(a,
d,b){return a?d:b}}[a]||b},D=function(a){var d=[].concat($jscomp.arrayFromIterable("+-*/%()".split("")),$jscomp.arrayFromIterable("0123456789.".split("")),$jscomp.arrayFromIterable(["$"," ","'"]),$jscomp.arrayFromIterable("& | ^ ~ << >> >>>".split(" ")),$jscomp.arrayFromIterable(["int","len"]));return[].concat($jscomp.arrayFromIterable(a)).filter(function(a){return d.includes(a)}).join("")},w=function(a){try{return[null,new Function("X","\n      const len = e => ('' + e).length;\n      const int = e => parseInt(e, 10);\n      try { return "+
a+"; } catch(e) { return; }\n      ")]}catch(k){return['Could not make a function with "'+a+'"',b]}},E=function(a,k){var d="Unable to clean math",c=b;e(a)?(a=k.reduce(function(a,d,b){return a.split("$"+(b+1)).join("X.get("+d+")")},D(a)),a.includes("$")||(c=$jscomp.makeIterator(w(a)),d=c.next().value,c=c.next().value)):(c=$jscomp.makeIterator(w(a)),d=c.next().value,c=c.next().value);return[d,c]},F=function(a,b){a=a.map(function(a){a=$jscomp.makeIterator(a);var d=a.next().value,c=a.next().value;if(e(c)&&
n(c)){var k=r(c);return[d,function(a){return a.get(b[k])}]}return[d,function(){return c}]});var d=new Map(a);return[null,function(a){var c=d.get(a.get(b[0]));return c?c(a):void 0}]},G=function(a,b){var d=p(a);return[null,function(a){return d(a.get(b[0]))}]},q=function(a,b){if(e(a)){var d=r(a);var c=function(a){return a.get(b[d])}}else c=function(){return a};return c},H=function(a,b){var d=$jscomp.makeIterator(a);a=d.next().value;var c=d.next().value,k=d.next().value;d=d.next().value;var e=q(a,b),
f=q(k,b),g=C(c),h=v(d);return[null,function(a){var d=$jscomp.makeIterator([e(a),f(a)]);a=d.next().value;d=d.next().value;return h(g(a,d),a,d)}]},I=function(a,b){var d=$jscomp.makeIterator(a);a=d.next().value;var c=d.next().value,k=d.next().value;d=d.next().value;var e=q(a,b),f=q(c,b),g=q(k,b),h=v(d);return[null,function(a){var d=$jscomp.makeIterator([e(a),f(a),g(a)]);a=d.next().value;var b=d.next().value;d=d.next().value;d=$jscomp.makeIterator([Math.min(b,d),Math.max(b,d)]);b=d.next().value;d=d.next().value;
return a>=b&&a<=d?h(!0,a,b):a>=b?h(!1,a,d):h(!1,a,b)}]},J=function(a,b){return[null,h(a,[null])?function(a){return a.get("data")}:function(d){return g(void 0,a)(d.get("data"))}]},K=function(a,b){b=$jscomp.makeIterator(a);a=b.next().value;b=b.next().value;var d=["_ev",a.toString(),b];return[null,function(a){return g(void 0,d)(a.get("data"))}]},l=function(a,c,e){var d=this;this._id=a;this._name=c;this._args=[];this._math=void 0;this._enum=[];this._comparator=[];this._between=[];this._path=this._round=
void 0;this._evCode=[];this._fallback=void 0;this._nodus="Not init";this._func=b;e&&(this._id=e.I,this.name=e.N,this.setFallback(e.D),this.setMath(e.M),e.E.forEach(function(a){return d.addEnum.apply(d,$jscomp.arrayFromIterable(a))}),this.setRound(e.R),this.setPath.apply(this,$jscomp.arrayFromIterable(e.P)),this.setComparator.apply(this,$jscomp.arrayFromIterable(e.C)),this.setBetween.apply(this,$jscomp.arrayFromIterable(e.B)),this.setEvCode.apply(this,$jscomp.arrayFromIterable(e.V)))};l.prototype.dump=
function(){return{I:this.id,N:this.name,A:this._args,D:this._fallback,M:this._math,E:this._enum,R:this._round,P:this._path,C:this._comparator,B:this._between,V:this._evCode}};l.prototype._clearAll=function(a){this._path=[];this._enum=void 0===a||a?[]:this._enum;this._comparator=[];this._between=[];this._evCode=[];this._math=this._round=void 0;this._nodus="Changed"};l.prototype.reset=function(){this._clearAll(!0);this._fallback=void 0;this._nodus="Not init"};l.prototype.addArg=function(a){this._args.push(a._id);
this._nodus="Args added";return this};l.prototype.delArg=function(a){this._args=this._args.filter(function(d){return d!==a._id});this._nodus="Args removed";return this};l.prototype.setFallback=function(a){this._fallback=a;return this};l.prototype.setEvCode=function(a,b){if(void 0!==a){this._clearAll();var d="data";b&&(b=b.toLowerCase(),d=["data","desc","code"].includes(b)?b:d);this._evCode=[a,d]}return this};l.prototype.setPath=function(a){for(var d=[],b=0;b<arguments.length;++b)d[b-0]=arguments[b];
[].concat($jscomp.arrayFromIterable(d)).length&&(this._clearAll(),this._path=[].concat($jscomp.arrayFromIterable(d)));return this};l.prototype.setMath=function(a){void 0!==a&&(this._clearAll(),this._math=a);return this};l.prototype.setRound=function(a){f(a)&&(this._clearAll(),this._round=p(0)(a));return this};l.prototype.setComparator=function(a,b,c,e){var d=!0;d=(f(a)||n(a))&&d;d=(f(c)||n(c))&&d;d="!= !== == === <= >= < >".split(" ").includes(b)&&d;if(d=["vu","10","tf","ab"].includes(e)&&d)this._clearAll(),
this._comparator=[a,b,c,e];return this};l.prototype.setBetween=function(a,b,c,e){var d=!0;d=(f(a)||n(a))&&d;d=(f(b)||n(b))&&d;d=(f(c)||n(c))&&d;if(d=["vu","10","tf","ab"].includes(e)&&d)this._clearAll(),this._between=[a,b,c,e];return this};l.prototype.addEnum=function(a,b){if(void 0===a)return this;this._clearAll(!1);this._enum=[].concat($jscomp.arrayFromIterable((new Map(this._enum)).set(a,b).entries()));return this};l.prototype.delEnum=function(a){this._enum=A(this._enum,a);this._nodus="Changed";
return this};l.prototype.clean=function(){var a=this;if(this.math){var b=$jscomp.makeIterator(E(this.math,this.args));this._nodus=b.next().value;this._func=b.next().value}else this.enum&&this.enum.length?(b=$jscomp.makeIterator(F(this.enum,this.args)),this._nodus=b.next().value,this._func=b.next().value):void 0!==this.round?(b=$jscomp.makeIterator(G(this.round,this.args)),this._nodus=b.next().value,this._func=b.next().value):this.comparator&&this.comparator.length?(b=$jscomp.makeIterator(H(this.comparator,
this.args)),this._nodus=b.next().value,this._func=b.next().value):this.between&&this.between.length?(b=$jscomp.makeIterator(I(this.between,this.args)),this._nodus=b.next().value,this._func=b.next().value):this.path&&this.path.length?(b=$jscomp.makeIterator(J(this.path,this.args)),this._nodus=b.next().value,this._func=b.next().value):this.evCode&&2===this.evCode.length?(b=$jscomp.makeIterator(K(this.evCode,this.args)),this._nodus=b.next().value,this._func=b.next().value):this._fallback&&(b=$jscomp.makeIterator([null,
function(){return a._fallback}]),this._nodus=b.next().value,this._func=b.next().value);return this};l.prototype.solve=function(a){if(this._nodus)this.clean();else{var d=this._func(a);return a.set(this._id,void 0===d?this.fallback:d)}return this._nodus?(a.set(this._id,void 0),a.set("err_"+this._id,!this._nodus),a):this.solve(a)};$jscomp.global.Object.defineProperties(l.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},name:{configurable:!0,enumerable:!0,get:function(){return this._name},
set:function(a){this._name=a}},args:{configurable:!0,enumerable:!0,get:function(){return this._args}},fallback:{configurable:!0,enumerable:!0,get:function(){return this._fallback}},evCode:{configurable:!0,enumerable:!0,get:function(){return this._evCode}},path:{configurable:!0,enumerable:!0,get:function(){return this._path}},math:{configurable:!0,enumerable:!0,get:function(){return this._math}},round:{configurable:!0,enumerable:!0,get:function(){return this._round}},comparator:{configurable:!0,enumerable:!0,
get:function(){return this._comparator}},between:{configurable:!0,enumerable:!0,get:function(){return this._between}},enum:{configurable:!0,enumerable:!0,get:function(){return this._enum}}});var x=function(a){var d=[].concat($jscomp.arrayFromIterable(a.keys())).reduce(function(a,d){return a.set(d,0)||a},new Map);[].concat($jscomp.arrayFromIterable(a.values())).forEach(function(a){return a.forEach(function(a){return d.set(a,d.has(a)?d.get(a)+1:0)})});a=[].concat($jscomp.arrayFromIterable(a.keys())).filter(function(a){return 0===
d.get(a)});return{C:d,Q:a}},L=function(a){var d=x(a),b=d.C,c=d.Q;for(d=[];c.length;){var e=c.pop();d.push(e);a.get(e).forEach(function(a){b.set(a,b.get(a)-1);0===b.get(a)&&c.push(a)})}return d},y=function(a){for(var d=$jscomp.makeIterator(a.entries()),b=d.next();!b.done;b=d.next()){var c=$jscomp.makeIterator(b.value);b=c.next().value;if(0===c.next().value.size&&0!==b){a.delete(b);c=$jscomp.makeIterator(a.values());for(var e=c.next();!e.done;e=c.next())e.value.delete(b)}}[].concat($jscomp.arrayFromIterable(a.entries())).reduce(function(a,
b){return a||0===b[1].size&&0!==b[0]},!1)&&y(a);return a},z=function(a){return function(b){return new l(a.next().value,b)}},m=function(){this._ref=this._meta=null;this._units=this._description="";this.G=new Map;this._nodeMaker=z(a());this._rootNode=this.makeNode("ROOT");this._rootNode.setMath("$1")};m.prototype.makeNode=function(a){a=this._nodeMaker(a);this.G.set(a,new Set);return a};m.prototype.addNode=function(b){if(this.G.has(b))return b;if(this.ids.includes(b.id))return!1;this.G.set(b,new Set);
this._nodeMaker=z(a(Math.max.apply(Math,$jscomp.arrayFromIterable(this.ids))));return b};m.prototype.delNode=function(a){var b=!1;if(a&&a!==this._rootNode&&(b=this.G.delete(a)))for(var d=$jscomp.makeIterator(this.G.entries()),c=d.next();!c.done;c=d.next()){c=$jscomp.makeIterator(c.value);var e=c.next().value;c.next().value.delete(a);e.delArg(a)}return b};m.prototype.connect=function(a,b){if(a===this.root||b===this.root&&0<this.indegrees(b).length||!this.G.has(a)||!this.G.has(b)||this.G.get(a).has(b))return this;
this.G.get(a).add(b);b.addArg(a);this.topo.length<this.nodes.length&&this.disconnect(a,b);return this};m.prototype.disconnect=function(a,b){this.G.has(a)&&(this.G.get(a).delete(b),b.delArg(a));return this};m.prototype.clean=function(){var a=this;this.orphans.forEach(function(b){return a.delNode(b)});this.orphans.length&&this.clean();this.nodes.forEach(function(a){return a.clean()});return this};m.prototype.indegrees=function(a){a=u(a);return[].concat($jscomp.arrayFromIterable(this.G.entries())).reduce(a,
[])};m.prototype.outdegrees=function(a){return[].concat($jscomp.arrayFromIterable(this.G.get(a)))};m.prototype.getIdG=function(){return[].concat($jscomp.arrayFromIterable(this.G)).reduce(function(a,b){var d=$jscomp.makeIterator(b);b=d.next().value;d=d.next().value;return a.set(b.id,new Set([].concat($jscomp.arrayFromIterable(d)).map(t)))},new Map)};m.prototype.solve=function(a){return this.getSolver()(a)};m.prototype.debug=function(a){return this.getSolver(!0)(a)};m.prototype.getSolver=function(a){a=
void 0===a?!1:a;var b=y(this.getIdG()),d=this.topo.filter(function(a){return b.has(a.id)}),c=d.map(t),e=d.map(function(a){return a.clean()}),f=this._rootNode.id,g=new Map;g.set("topoIds",c);return function(b){g.set("data",b);b=e.reduce(function(a,b){return b.solve(a)},g);return a?b:b.get(f)}};m.prototype.dump=function(){return JSON.stringify({M:[this.description,this.units,this.ref],G:[].concat($jscomp.arrayFromIterable(this.getIdG())).map(function(a){var b=$jscomp.makeIterator(a);a=b.next().value;
b=b.next().value;return[a,[].concat($jscomp.arrayFromIterable(b))]}),N:this.topo.map(function(a){return a.dump()})})};m.prototype.read=function(a,b){var d=this;b=void 0===b?!0:b;var c=B(a);a=this.dump();if(c)try{this.G=new Map;this._rootNode=void 0;var e=c.N.map(function(a){return new l(void 0,void 0,a)}),f=function(a){return function(b){return b.id===a}},g=new Map(c.G);this._rootNode=void 0;for(var h=$jscomp.makeIterator(g.keys()),k=h.next();!k.done;k=h.next())this.addNode(e.find(f(k.value)));this._rootNode=
this.nodes[0];h={};for(var m=$jscomp.makeIterator(g.entries()),n=m.next();!n.done;h={node:h.node},n=m.next()){var p=$jscomp.makeIterator(n.value),q=p.next().value,r=p.next().value;h.node=e.find(f(q));r.forEach(function(a){return function(b){b=e.find(f(b));d.connect(a.node,b)}}(h))}this.nodes.forEach(function(a){a._args=c.N.find(function(b){return b.I===a.id}).A});this.description=c.M?c.M[0]||"":"";this.units=c.M?c.M[1]||"":"";this.ref=c.M?c.M[2]:null;return this}catch(O){b&&this.read(a,!1)}};$jscomp.global.Object.defineProperties(m.prototype,
{meta:{configurable:!0,enumerable:!0,get:function(){return this._meta},set:function(a){this._meta=a}},description:{configurable:!0,enumerable:!0,get:function(){return this._description},set:function(a){this._description=e(a)?a:this._description}},units:{configurable:!0,enumerable:!0,get:function(){return this._units},set:function(a){this._units=e(a)?a:this._units}},ref:{configurable:!0,enumerable:!0,get:function(){return this._ref},set:function(a){this._ref=void 0!==a?a:null}},root:{configurable:!0,
enumerable:!0,get:function(){return this._rootNode}},nodes:{configurable:!0,enumerable:!0,get:function(){return[].concat($jscomp.arrayFromIterable(this.G.keys()))}},graph:{configurable:!0,enumerable:!0,get:function(){return this.G}},topo:{configurable:!0,enumerable:!0,get:function(){return L(this.G)}},leafs:{configurable:!0,enumerable:!0,get:function(){return x(this.G).Q}},orphans:{configurable:!0,enumerable:!0,get:function(){for(var a=[],b=$jscomp.makeIterator(this.G.entries()),c=b.next();!c.done;c=
b.next()){c=$jscomp.makeIterator(c.value);var e=c.next().value;0===c.next().value.size&&e!==this._rootNode&&a.push(e)}return a}},names:{configurable:!0,enumerable:!0,get:function(){return this.nodes.map(function(a){return a.name})}},topoNames:{configurable:!0,enumerable:!0,get:function(){return this.topo.map(function(a){return a.name})}},ids:{configurable:!0,enumerable:!0,get:function(){return this.nodes.map(function(a){return a.id})}},topoIds:{configurable:!0,enumerable:!0,get:function(){return this.topo.map(function(a){return a.id})}}});
return m}();
